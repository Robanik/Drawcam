<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Robiks YouTube</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: linear-gradient(to right, #1e3c72, #2a5298);
    color: #fff;
    margin: 0;
    padding: 0;
}
header {
    background: linear-gradient(to right, #ff416c, #ff4b2b);
    padding: 15px;
    text-align: center;
    font-size: 24px;
    font-weight: bold;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3);
}
nav {
    display: flex;
    justify-content: center;
    background: rgba(0,0,0,0.3);
    padding: 10px;
}
nav button {
    background: rgba(255,255,255,0.2);
    border: none;
    color: #fff;
    padding: 10px 20px;
    margin: 0 5px;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
}
nav button:hover {
    background: rgba(255,255,255,0.4);
}
.video {
    border: 1px solid rgba(255,255,255,0.3);
    margin: 15px;
    padding: 10px;
    border-radius: 10px;
    background: rgba(0,0,0,0.4);
}
video {
    max-width: 100%;
    border-radius: 10px;
    margin-top: 10px;
}
input, button {
    margin: 5px;
    padding: 8px;
    border-radius: 5px;
    border: none;
}
input {
    width: 200px;
}
button {
    background: #ff416c;
    color: #fff;
    font-weight: bold;
    cursor: pointer;
}
button:hover {
    background: #ff4b2b;
}
#main {
    max-width: 900px;
    margin: auto;
    padding: 20px;
}
.search-bar {
    text-align: center;
    margin-bottom: 20px;
}
</style>
</head>
<body>
<header>ROBIKS</header>
<nav id="tabs"></nav>
<div class="search-bar">
    <input id="search-input" placeholder="–ü–æ–∏—Å–∫ –≤–∏–¥–µ–æ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –∞–≤—Ç–æ—Ä—É"><button onclick="searchVideos()">üîç</button>
</div>
<div id="main"></div>
<script>
if(!localStorage.getItem('users')) localStorage.setItem('users', JSON.stringify({}));
if(!localStorage.getItem('videos')) localStorage.setItem('videos', JSON.stringify([]));
let currentUser = null;
let likedVideos = JSON.parse(localStorage.getItem('likedVideos')||'{}');

function saveUsers(users){ localStorage.setItem('users', JSON.stringify(users)); }
function loadUsers(){ return JSON.parse(localStorage.getItem('users')); }
function saveVideos(videos){ localStorage.setItem('videos', JSON.stringify(videos)); }
function loadVideos(){ return JSON.parse(localStorage.getItem('videos')); }
function saveLikedVideos(){ localStorage.setItem('likedVideos', JSON.stringify(likedVideos)); }

function showUserPanel(){
    const tabs = document.getElementById('tabs');
    tabs.innerHTML = '';
    if(currentUser){
        const users = loadUsers();
        tabs.innerHTML = `<button onclick='showVideos()'>–ì–ª–∞–≤–Ω–∞—è</button><button onclick='showUpload()'>–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ</button><button onclick='logout()'>–í—ã–π—Ç–∏ (${currentUser}${users[currentUser].isOwner?'‚úî':''})</button>`;
    } else {
        tabs.innerHTML = `<button onclick='showRegister()'>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button><button onclick='showLogin()'>–í—Ö–æ–¥</button><button onclick='showVideos()'>–ì–ª–∞–≤–Ω–∞—è</button>`;
    }
}

function showRegister(){
    document.getElementById('main').innerHTML = `
        <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
        <input id='reg-nick' placeholder='–ù–∏–∫'><br>
        <input id='reg-pass' placeholder='–ü–∞—Ä–æ–ª—å' type='password'><br>
        <button onclick='register()'>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
    `;
}
function showLogin(){
    document.getElementById('main').innerHTML = `
        <h2>–í—Ö–æ–¥</h2>
        <input id='log-nick' placeholder='–ù–∏–∫'><br>
        <input id='log-pass' placeholder='–ü–∞—Ä–æ–ª—å' type='password'><br>
        <button onclick='login()'>–í–æ–π—Ç–∏</button>
    `;
}
function showUpload(){
    if(!currentUser) return;
    document.getElementById('main').innerHTML = `
        <h2>–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ</h2>
        <input type='file' id='video-file' accept='video/*'><br>
        <input id='video-title' placeholder='–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ'><br>
        <button onclick='uploadVideo()'>–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
    `;
}

function showVideos(filteredVideos=null){
    let html = '<h2>–í–∏–¥–µ–æ</h2>';
    const videos = filteredVideos||loadVideos();
    const users = loadUsers();
    videos.forEach((v,i)=>{
        html += `<div class='video'><p>–ê–≤—Ç–æ—Ä: ${v.uploader} ${users[v.uploader].isOwner?'‚úî':''}</p>
        <p>${v.title}</p>
        <video controls src='${v.url}'></video>
        <p>üëç ${v.likes} | üëé ${v.dislikes}</p>`;
        if(currentUser){
            html += `<button onclick='like(${i})' ${likedVideos[currentUser]&&likedVideos[currentUser].includes(i)?'disabled':''}>üëç</button>`;
            html += `<button onclick='dislike(${i})' ${likedVideos[currentUser]&&likedVideos[currentUser].includes(i)?'disabled':''}>üëé</button>`;
            html += `<input id='cmt-${i}' placeholder='–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'><button onclick='comment(${i})'>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>`;
            if(v.uploader===currentUser) html += `<button onclick='deleteVideo(${i})'>–£–¥–∞–ª–∏—Ç—å –≤–∏–¥–µ–æ</button>`;
        }
        html += `<ul>${v.comments.map(c=>`<li>${c.user}: ${c.text}</li>`).join('')}</ul></div>`;
    });
    document.getElementById('main').innerHTML = html;
}

function register(){
    const nick = document.getElementById('reg-nick').value;
    const pass = document.getElementById('reg-pass').value;
    const users = loadUsers();
    if(users[nick]){ alert('–ù–∏–∫ –∑–∞–Ω—è—Ç'); return; }
    users[nick] = {password: pass, isOwner: nick==='ROBANIKOWNER'};
    saveUsers(users);
    currentUser = nick;
    showUserPanel();
    showVideos();
}
function login(){
    const nick = document.getElementById('log-nick').value;
    const pass = document.getElementById('log-pass').value;
    const users = loadUsers();
    if(users[nick] && users[nick].password===pass){
        currentUser = nick;
        if(!likedVideos[currentUser]) likedVideos[currentUser]=[];
        showUserPanel();
        showVideos();
    } else { alert('–ù–µ–≤–µ—Ä–Ω—ã–π –Ω–∏–∫ –∏–ª–∏ –ø–∞—Ä–æ–ª—å'); }
}
function logout(){ currentUser=null; showUserPanel(); showVideos(); }

function uploadVideo(){
    const fileInput = document.getElementById('video-file');
    const title = document.getElementById('video-title').value;
    if(!fileInput.files[0] || !title) return;
    const reader = new FileReader();
    reader.onload = function(e){
        const videos = loadVideos();
        videos.push({uploader: currentUser, title: title, url: e.target.result, likes:0, dislikes:0, comments:[]});
        saveVideos(videos);
        showVideos();
    };
    reader.readAsDataURL(fileInput.files[0]);
}

function like(i){
    if(!likedVideos[currentUser]) likedVideos[currentUser]=[];
    if(likedVideos[currentUser].includes(i)) return;
    const videos=loadVideos(); videos[i].likes++; saveVideos(videos);
    likedVideos[currentUser].push(i); saveLikedVideos(); showVideos();
}
function dislike(i){
    if(!likedVideos[currentUser]) likedVideos[currentUser]=[];
    if(likedVideos[currentUser].includes(i)) return;
    const videos=loadVideos(); videos[i].dislikes++; saveVideos(videos);
    likedVideos[currentUser].push(i); saveLikedVideos(); showVideos();
}
function comment(i){ const text=document.getElementById('cmt-'+i).value; if(!text) return; const videos=loadVideos(); videos[i].comments.push({user:currentUser,text}); saveVideos(videos); showVideos(); }
function deleteVideo(i){ const videos=loadVideos(); videos.splice(i,1); saveVideos(videos); showVideos(); }

function searchVideos(){
    const query = document.getElementById('search-input').value.toLowerCase();
    const videos = loadVideos().filter(v=>v.title.toLowerCase().includes(query) || v.uploader.toLowerCase().includes(query));
    showVideos(videos);
}

showUserPanel(); showVideos();
</script>
</body>
  </html>
  
